/*!
 * Basic postMessage Support - v0.1
 *
 * Copyright (c) 2013-2014 Dave Olsen, http://dmolsen.com
 * Licensed under the MIT license
 *
 * Handles the postMessage stuff in the pattern, view-all, and style guide templates.
 *
 */// alert the iframe parent that the pattern has loaded assuming this view was loaded in an iframe
function receiveIframeMessage(e){var t,n=typeof e.data!="string"?e.data:JSON.parse(e.data);if(window.location.protocol!="file:"&&e.origin!==window.location.protocol+"//"+window.location.host)return;if(n.path!==undefined)if(patternPartial!==""){var r=/patterns\/(.*)$/;t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(r,"")+n.path+"?"+Date.now();window.location.replace(t)}else{t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+n.path+"?"+Date.now();window.location.replace(t)}else n.reload!==undefined&&window.location.reload()}if(self!=top){var path=window.location.toString(),parts=path.split("?"),options={path:parts[0]};options.patternpartial=patternPartial!==""?patternPartial:"all";lineage!==""&&(options.lineage=lineage);var targetOrigin=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);var aTags=document.getElementsByTagName("a");for(var i=0;i<aTags.length;i++)aTags[i].onclick=function(e){e.preventDefault();var t=this.getAttribute("href");t!="#"&&window.location.replace(t)};var keys=["s","m","l","d","h","f"];for(var i=0;i<keys.length;i++)jwerty.key("ctrl+shift+"+keys[i],function(e,t){return function(n){var r=JSON.stringify({keyPress:"ctrl+shift+"+e});parent.postMessage(r,t);return!1}}(keys[i],targetOrigin));var i=0;while(i<10){jwerty.key("ctrl+shift+"+i,function(e,t){return function(n){var r=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host,i=JSON.stringify({keyPress:"ctrl+shift+"+e});parent.postMessage(i,t);return!1}}(i,targetOrigin));i++}}var body=document.getElementsByTagName("body");body[0].onclick=function(){var e=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host,t=JSON.stringify({bodyclick:"bodyclick"});parent.postMessage(t,e)};window.addEventListener("message",receiveIframeMessage,!1);