/*!
 * Annotations Support for Patterns - v0.3
 *
 * Copyright (c) 2013 Dave Olsen, http://dmolsen.com
 * Licensed under the MIT license
 *
 */var annotationsPattern={commentsOverlayActive:!1,commentsOverlay:!1,commentsOverlayElement:"",commentsEmbeddedActive:!1,commentsEmbedded:!1,showComments:function(){var e=document.getElementsByTagName("body");if(!e[0].classList.contains("pattern-list"))for(comment in comments.comments){var t=comments.comments[comment],n=document.querySelectorAll(t.el);for(var r=0;r<n.length;++r)n[r].onclick=function(e){return function(t){t.preventDefault();t.stopPropagation();var n={};if(annotationsPattern.commentsOverlayActive&&!annotationsPattern.commentsOverlay){annotationsPattern.commentsOverlay=!0;n={commentOverlay:"on",swapOverlay:!1,el:e.el,title:e.title,comment:e.comment}}else if(annotationsPattern.commentsOverlayActive&&annotationsPattern.commentsOverlay)if(e.el==annotationsPattern.commentsOverlayElement){annotationsPattern.commentsOverlay=!1;n={commentOverlay:"off"}}else n={commentOverlay:"on",swapOverlay:!0,el:e.el,title:e.title,comment:e.comment};annotationsPattern.commentsOverlayElement=e.el;var r=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(n,r)}}(t)}},embedComments:function(e,t,n){var r=document.createElement("div");r.classList.add("sg-annotation");var i=document.createElement("h3"),s=document.createElement("p");i.innerHTML=t;s.innerHTML=n;r.appendChild(i);r.appendChild(s);var o=annotationsPattern.findParent(e),u=o.getElementsByClassName("sg-annotations");if(u.length>0)u[0].appendChild(r);else{var a=document.createElement("div");a.classList.add("sg-annotations");a.appendChild(r);o.appendChild(a)}},findParent:function(e){if(e.parentNode.classList.contains("sg-pattern"))return e.parentNode;var t=annotationsPattern.findParent(e.parentNode);return t},receiveIframeMessage:function(e){if(window.location.protocol!="file:"&&e.origin!==window.location.protocol+"//"+window.location.host)return;if(e.data.commentToggle!=undefined){annotationsPattern.commentsOverlayActive=!1;annotationsPattern.commentsEmbeddedActive=!1;var t=document.getElementsByTagName("body");e.data.commentToggle=="on"&&t[0].classList.contains("pattern-list")?annotationsPattern.commentsEmbeddedActive=!0:e.data.commentToggle=="on"&&(annotationsPattern.commentsOverlayActive=!0);if(!annotationsPattern.commentsOverlayActive){var n=document.querySelectorAll(".has-comment");for(var r=0;r<n.length;r++)n[r].classList.remove("has-comment")}if(!annotationsPattern.commentsEmbeddedActive){var n=document.getElementsByClassName("sg-annotations");for(var r=0;r<n.length;r++)n[r].style.display="none"}if(annotationsPattern.commentsOverlayActive)for(comment in comments.comments){var i=comments.comments[comment],n=document.querySelectorAll(i.el);for(var r=0;r<n.length;r++)n[r].classList.add("has-comment")}else if(annotationsPattern.commentsEmbeddedActive&&!annotationsPattern.commentsEmbedded)for(comment in comments.comments){var i=comments.comments[comment],n=document.querySelectorAll(i.el);n.length>0&&annotationsPattern.embedComments(n[0],i.title,i.comment);annotationsPattern.commentsEmbedded=!0}else if(annotationsPattern.commentsEmbeddedActive&&annotationsPattern.commentsEmbedded){var n=document.getElementsByClassName("sg-annotations");for(var r=0;r<n.length;++r)n[r].style.display="block"}}}};annotationsPattern.showComments();window.addEventListener("message",annotationsPattern.receiveIframeMessage,!1);window.onbeforeunload=function(){var e={commentOverlay:"off"},t=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(e,t)};